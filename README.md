# 家庭云盘

一个功能完整的家庭云盘应用，支持文件存储、管理、分享和预览，仅存储在本地设备硬盘中，不进行云端同步。

## 功能特性

### 核心功能
- ✅ 文件存储与管理：上传、下载、删除、重命名
- ✅ 文件夹管理：创建、浏览、删除、重命名
- ✅ 批量操作：批量上传、批量下载、批量删除
- ✅ 文件夹下载：支持整个文件夹下载为ZIP压缩包
- ✅ 文件预览：支持图片、视频、音频、文本等常见格式预览

### 网络访问
- ✅ 同一局域网内设备可通过浏览器访问
- ✅ 设备发现功能：局域网内设备可自动识别并连接

### 安全要求
- ✅ 基本用户认证机制
- ✅ JWT令牌授权

### 性能与稳定性
- ✅ 支持后台运行模式
- ✅ 优化文件传输速度
- ✅ 断点续传功能

### 附加功能
- ✅ 响应式设计：适配不同设备屏幕尺寸
- ✅ 文件搜索功能

## 技术栈

- **后端**：Node.js + Express框架
- **前端**：React.js + Ant Design组件库
- **数据库**：SQLite（轻量级，无需额外安装）
- **文件存储**：本地文件系统
- **设备发现**：mDNS（Bonjour/ZeroConf协议）
- **认证**：JWT（JSON Web Token）

## 部署步骤

### 1. 环境要求
- Node.js 14.0 或更高版本
- npm 6.0 或更高版本

### 2. 安装与启动

#### 方法一：使用启动脚本（推荐）

```bash
# 1. 下载项目到本地
# 2. 进入项目目录
cd 家庭云盘

# 3. 执行启动脚本
./start.sh start
```

#### 方法二：手动安装与启动

```bash
# 1. 安装后端依赖
npm install

# 2. 安装前端依赖
cd frontend
npm install

# 3. 构建前端代码
npm run build

# 4. 返回项目根目录
cd ..

# 5. 启动服务
npm start
```

### 3. 访问服务

- **浏览器访问**：在浏览器中输入 `http://服务器IP:3000`
- **设备发现**：在支持mDNS的设备上，可直接访问 `http://familyclouddrive.local:3000`

## 使用说明

### 1. 用户注册与登录

1. 第一次使用时，点击"立即注册"创建新用户
2. 注册成功后，使用用户名和密码登录
3. 登录后进入文件管理界面

### 2. 文件管理

#### 上传文件
1. 点击"上传文件"按钮
2. 选择要上传的文件，支持多选
3. 等待上传完成

#### 下载文件
1. 点击文件右侧的"下载"按钮
2. 选择保存位置

#### 批量下载
1. 勾选多个文件
2. 点击"批量下载"按钮
3. 系统会将选中的文件打包为ZIP格式下载

#### 下载整个文件夹
1. 进入要下载的文件夹
2. 点击"下载当前文件夹"按钮
3. 系统会将整个文件夹打包为ZIP格式下载

#### 创建文件夹
1. 点击"创建文件夹"按钮
2. 输入文件夹名称
3. 点击"创建"

#### 删除文件或文件夹
1. 点击文件或文件夹右侧的"删除"按钮
2. 确认删除操作

#### 重命名文件或文件夹
1. 点击文件或文件夹右侧的"重命名"按钮
2. 输入新名称
3. 点击"确定"

#### 文件预览
1. 点击图片、视频、音频等支持预览的文件右侧的"预览"按钮
2. 在弹出的预览窗口中查看文件内容

### 3. 文件夹导航

- 在左侧文件夹树中点击文件夹名称进入对应文件夹
- 文件夹树支持展开和折叠

## 命令说明

### 启动脚本命令

```bash
# 启动服务
./start.sh start

# 停止服务
./start.sh stop

# 重启服务
./start.sh restart

# 查看服务状态
./start.sh status

# 仅安装依赖和构建前端
./start.sh install
```

### PM2命令（如果使用PM2启动）

```bash
# 查看服务状态
pm2 status

# 停止服务
pm2 stop family-cloud-drive

# 重启服务
pm2 restart family-cloud-drive

# 查看服务日志
pm2 logs family-cloud-drive
```

## 项目结构

```
家庭云盘/
├── backend/              # 后端代码
├── frontend/             # 前端代码
├── data/                 # 数据存储目录
│   ├── db/               # 数据库文件
│   └── files/            # 用户上传文件
├── start.sh              # 启动脚本
├── package.json          # 后端依赖
└── README.md             # 项目说明
```

## 配置说明

### 环境变量配置

可通过修改 `.env` 文件调整服务配置：

```env
# 服务器配置
PORT=3000                # 服务端口
HOST=0.0.0.0             # 服务地址

# 数据库配置
DB_PATH=data/db/family_cloud.db  # 数据库文件路径

# 文件存储配置
FILE_STORAGE_PATH=data/files     # 文件存储路径

# JWT配置
JWT_SECRET=your_jwt_secret_key   # JWT密钥
JWT_EXPIRES_IN=24h               # JWT过期时间

# 设备发现配置
MDNS_NAME=FamilyCloudDrive       # mDNS服务名称
MDNS_TYPE=http                   # 服务类型
MDNS_PROTOCOL=tcp                # 服务协议
```

## 注意事项

1. **数据安全**：请定期备份 `data` 目录，以防止数据丢失
2. **性能建议**：对于大量文件或大文件存储，建议使用SSD硬盘
3. **网络环境**：确保服务器和客户端在同一局域网内
4. **端口占用**：如果3000端口被占用，可在 `.env` 文件中修改 `PORT` 配置
5. **后台运行**：推荐使用PM2实现服务的后台运行和自动重启

## 常见问题

### Q: 如何修改服务端口？
A: 修改 `.env` 文件中的 `PORT` 配置，然后重启服务。

### Q: 如何查看服务日志？
A: 如果使用PM2启动，可通过 `pm2 logs family-cloud-drive` 查看日志。

### Q: 忘记密码怎么办？
A: 目前不支持密码重置功能，可重新注册新用户。

### Q: 支持哪些文件格式预览？
A: 支持图片（JPG、PNG、GIF等）、视频（MP4、WebM等）、音频（MP3、WAV等）、文本（TXT、MD等）等常见格式。

## 更新日志

### v1.0.0 (2026-01-18)
- 初始版本发布
- 实现核心文件管理功能
- 支持批量操作和文件夹下载
- 实现设备发现功能
- 支持文件预览

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request！

## 联系方式

如有问题或建议，可通过以下方式联系：
- 邮箱：your-email@example.com
- GitHub：https://github.com/your-username/family-cloud-drive
